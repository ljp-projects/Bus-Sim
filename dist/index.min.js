"use strict";const Routes=Object.freeze({MakeRoute:e=>{var s={"Albanese Beach":1e3,Scomoville:2e3,"Edison Square":2100,"Finhorn Valley":1100,Musk:1110,Eloneville:3e3,"Musk Square":1111,"Anthony Corner":1120,"El Salvador":3100,length:9};const n=[];for(let t=0;t<e;t++){var o=Math.max(~~(17*Math.random()),4),l=Object.keys(s)[~~(Math.random()*s.length)];n.push({name:l,code:s[l],timeSecs:o})}return{stops:n,totalTimeSecs:(()=>{let e=0;return n.forEach(t=>{e+=t.timeSecs}),e})()}},TravelRoute:o=>{!function t(e){const s=o.stops[o.stops.indexOf(e)!==o.stops.length-1?o.stops.indexOf(e)+1:-1],n=o.stops[0!==o.stops.indexOf(e)?o.stops.indexOf(e)-1:-1];console.log(null==n?`Travelling to ${e.name} (${e.code}), which would take ${e.timeSecs} irl seconds, or ${5*e.timeSecs} game minutes.`:`Travelling to ${e.name} (${e.code}) from ${n.name} (${n.code}), which would take ${e.timeSecs} irl seconds, or ${5*e.timeSecs} game minutes.`),setTimeout(()=>{null!=s?t(s):console.log(`Finished travelling! Travel took ${o.totalTimeSecs} irl seconds, or ${5*o.totalTimeSecs} game minutes.`)},1e3*e.timeSecs)}(o.stops[0])},length:2});class Bus{constructor(t,e,s){this.hasRoute=!1,this.status=0,this.name=t,this.id=e,s&&this.addRoute(s)}addRoute(t){return this.hasRoute=!0,this.route=t,this}forEach(l,u,i){this.route&&this.route.stops.forEach((e,s,n)=>{var o=Object.keys(e);for(let t=0;t<o.length-(i||0);t+=u||1)l(o[t],Object.values(e)[t],s,n)})}removeRoute(){return this.hasRoute=!1,this.route=void 0,this}travel(o){if(this.route&&this.hasRoute){const l=t=>{if(this.route&&this.hasRoute){var e=this.route.stops.indexOf(t);console.log(e);const n=this.route.stops[e!==this.route.stops.length-1?e+1:-1];var s=this.route.stops[0!==e?e-1:-1];this.status<=8?o[0](this.status,t,null!=n?n:null,null!=s?s:null):9===this.status?o[1](this.status,t,null!=n?n:null,null!=s?s:null):10===this.status&&o[2](this.status,t,null!=n?n:null,null!=s?s:null),e%2!=0&&this.status<=8||(this.status=~~(11*Math.random())),n&&setTimeout(()=>l(n),1e3*t.timeSecs)}};l(this.route.stops[0])}return this}addToList(t){var e=`
        <b>${this.name}</b>
        <p>(${this.id})</p>
        <br>
        <button id="BUS-${this.id}-CHECK" class="check">Check</button>
        `,s=document.createElement("li");return s.innerHTML=e,setTimeout(()=>{var t=document.getElementById(`BUS-${this.id}-CHECK`);null!=t&&t.addEventListener("click",()=>{this.openDialog()})},100),null!=t&&t.appendChild(s),this}addCloseDialogListener(){var t=document.getElementById(`BUS-${this.id}-CLOSE`);const e=document.getElementById("about-bus"),s=document.getElementById("content");e&&s&&t&&t.addEventListener("click",()=>{s.setAttribute("class","noblur"),e.close(),e.innerHTML=""})}openDialog(){var t=document.getElementById("content"),e=document.getElementById("about-bus"),s=`
        <h2>${this.name}</h2>
        <p>${this.status<=8?"Normal":9===this.status?"Bus has broken down.":10===this.status?"Bus is out of fuel":"UNKOWN"}</p>
        <p id="BUS-${this.id}-STOP" class="stop">UNKNOWN STOP</p>
        <button id="BUS-${this.id}-CLOSE" class="close">Close</button>
        `;e&&(e.innerHTML=s,null!=t&&t.setAttribute("class","blur"),e.showModal(),setTimeout(this.addCloseDialogListener.bind(this),100))}tick(t,e){setInterval(t,1e3*e)}}let money=0,busPrice=100;const chooseEvent=()=>{return~~(3*Math.random())},addNewBus=()=>{if(money>=busPrice){var t=null==(t=document.getElementById("new-bus-name"))?void 0:t.value;const l=new Bus(t,(new Date).getTime());var t=document.getElementById("money"),e=document.getElementById("add-new-bus-cost");return l.addToList(document.getElementById("buses")),l.travel([(t,e,s,n)=>{var o=document.querySelector(`BUS-${l.id}-STOP`);null!=o&&(o.textContent=`Current stop: ${e.name}, Next stop: ${(null==s?void 0:s.name)||"UNKNOWN"}, Previous stop: `+((null==n?void 0:n.name)||"UNKNOWN"))},(t,e,s,n)=>{var o=document.querySelector(`BUS-${l.id}-STOP`);null!=o&&(o.textContent=`Current stop: ${e.name}, Next stop: ${(null==s?void 0:s.name)||"UNKNOWN"}, Previous stop: `+((null==n?void 0:n.name)||"UNKNOWN"))},(t,e,s,n)=>{var o=document.querySelector(`BUS-${l.id}-STOP`);null!=o&&(o.textContent=`Current stop: ${e.name}, Next stop: ${(null==s?void 0:s.name)||"UNKNOWN"}, Previous stop: `+((null==n?void 0:n.name)||"UNKNOWN"))}]),money-=busPrice,t&&(t.textContent=money.toString()),busPrice*=1.3,e&&(e.textContent=money.toString()),!0}return!1},addButton=document.getElementById("add"),earn=document.getElementById("earn");null!==earn&&void 0!==earn&&earn.addEventListener("click",()=>{var t=document.getElementById("money");money++,t&&(t.textContent=money.toString())}),null!==addButton&&void 0!==addButton&&addButton.addEventListener("click",()=>{const t=document.getElementById("content"),e=document.getElementById("add-bus");var s=document.getElementById("add-new-bus"),n=document.getElementById("add-bus-close");null!==t&&void 0!==t&&t.setAttribute("class","blur"),e.showModal(),null!=s&&s.addEventListener("click",()=>{addNewBus()&&(null!==t&&void 0!==t&&t.setAttribute("class","noblur"),e.close())}),null!=n&&n.addEventListener("click",()=>{null!==t&&void 0!==t&&t.setAttribute("class","noblur"),e.close()})});