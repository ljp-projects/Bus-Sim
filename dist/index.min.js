"use strict";const Routes=Object.freeze({MakeRoute:t=>{var s={"Albanese Beach":1e3,Scomoville:2e3,"Edison Square":2100,"Finhorn Valley":1100,Musk:1110,Eloneville:3e3,"Musk Square":1111,"Anthony Corner":1120,"El Salvador":3100,length:9};const o=[];for(let e=0;e<t;e++){var n=Math.max(~~(17*Math.random()),4),l=Object.keys(s)[~~(Math.random()*s.length)];o.push({name:l,code:s[l],timeSecs:n})}return{stops:o,totalTimeSecs:(()=>{let t=0;return o.forEach(e=>{t+=e.timeSecs}),t})()}},TravelRoute:n=>{!function e(t){const s=n.stops[n.stops.indexOf(t)!==n.stops.length-1?n.stops.indexOf(t)+1:-1],o=n.stops[0!==n.stops.indexOf(t)?n.stops.indexOf(t)-1:-1];console.log(null==o?`Travelling to ${t.name} (${t.code}), which would take ${t.timeSecs} irl seconds, or ${5*t.timeSecs} game minutes.`:`Travelling to ${t.name} (${t.code}) from ${o.name} (${o.code}), which would take ${t.timeSecs} irl seconds, or ${5*t.timeSecs} game minutes.`),setTimeout(()=>{null!=s?e(s):console.log(`Finished travelling! Travel took ${n.totalTimeSecs} irl seconds, or ${5*n.totalTimeSecs} game minutes.`)},1e3*t.timeSecs)}(n.stops[0])},length:2});class Bus{constructor(e,t,s){this.hasRoute=!1,this.status=0,this.name=e,this.id=t,s&&this.addRoute(s)}addRoute(e){return this.hasRoute=!0,this.route=e,this}forEach(l,i,u){this.route&&this.route.stops.forEach((t,s,o)=>{var n=Object.keys(t);for(let e=0;e<n.length-(u||0);e+=i||1)l(n[e],Object.values(t)[e],s,o)})}removeRoute(){return this.hasRoute=!1,this.route=void 0,this}travel(){if(this.route&&this.hasRoute){const n=e=>{if(this.route&&this.hasRoute){var t=this.route.stops.indexOf(e);console.log(t);const o=this.route.stops[t!==this.route.stops.length-1?t+1:-1];var s=this.route.stops[0!==t?t-1:-1];this.status<=8?console.log(e,null!=o?o:null,null!=s?s:null):9===this.status?console.log("Bus has broken down."):10===this.status&&console.log("Bus is out of fuel."),t%2!=0&&this.status<=8||(this.status=~~(11*Math.random())),o&&setTimeout(()=>n(o),1e3*e.timeSecs)}};n(this.route.stops[0])}return this}addToList(e){var t=`
        <b>${this.name}</b>
        <p>(${this.id})</p>
        <br>
        <button id="BUS-${this.id}-CHECK" class="check">Check</button>
        `,s=document.createElement("li");return s.innerHTML=t,setTimeout(()=>{var e=document.getElementById(`BUS-${this.id}-CHECK`);null!=e&&e.addEventListener("click",()=>{this.openDialog()})},100),null!=e&&e.appendChild(s),this}addCloseDialogListener(){var e=document.getElementById(`BUS-${this.id}-CLOSE`);const t=document.getElementById("about-bus"),s=document.getElementById("content");t&&s&&e&&e.addEventListener("click",()=>{s.setAttribute("class","noblur"),t.close(),t.innerHTML=""})}openDialog(){var e=document.getElementById("content"),t=document.getElementById("about-bus"),s=`
        <h2>${this.name}</h2>
        <p>${this.status<=8?"Normal":9===this.status?"Bus has broken down.":10===this.status?"Bus is out of fuel":"UNKOWN"}</p>
        <button id="BUS-${this.id}-CLOSE" class="close">Close</button>
        `;t&&(t.innerHTML=s,null!=e&&e.setAttribute("class","blur"),t.showModal(),setTimeout(this.addCloseDialogListener.bind(this),100))}}let money=0,busPrice=100;const addNewBus=()=>{var e,t,s;return money>=busPrice&&(e=null==(e=document.getElementById("new-bus-name"))?void 0:e.value,e=new Bus(e,(new Date).getTime()),t=document.getElementById("money"),s=document.getElementById("add-new-bus-cost"),e.addToList(document.getElementById("buses")),money-=busPrice,t&&(t.textContent=money.toString()),busPrice*=1.3,s&&(s.textContent=money.toString()),!0)},addButton=document.getElementById("add"),earn=document.getElementById("earn"),test=(null!==earn&&void 0!==earn&&earn.addEventListener("click",()=>{var e=document.getElementById("money");money++,e&&(e.textContent=money.toString())}),null!==addButton&&void 0!==addButton&&addButton.addEventListener("click",()=>{const e=document.getElementById("content"),t=document.getElementById("add-bus");var s=document.getElementById("add-new-bus"),o=document.getElementById("add-bus-close");null!==e&&void 0!==e&&e.setAttribute("class","blur"),t.showModal(),null!=s&&s.addEventListener("click",()=>{addNewBus()&&(null!==e&&void 0!==e&&e.setAttribute("class","noblur"),t.close())}),null!=o&&o.addEventListener("click",()=>{null!==e&&void 0!==e&&e.setAttribute("class","noblur"),t.close()})}),new Bus("Test",(new Date).getTime(),Routes.MakeRoute(5)));test.forEach((e,t)=>console.log(e,t),1,2);